<%= form_with model: [trip, activity], html: { novalidate: true } do |form| %>
  <% submit_label = activity.persisted? ? "更新する" : "追加する" %>
  <% submit_loading = activity.persisted? ? "更新中..." : "追加中..." %>
  <% title_error = activity.errors[:title].present? %>
  <% date_error  = activity.errors[:date].present? %>
  <% cost_error  = activity.errors[:cost].present? %>
  <% title_error_message = activity.errors.full_messages_for(:title).first %>
  <% date_error_message = activity.errors.full_messages_for(:date).first %>
  <% cost_error_message = activity.errors.full_messages_for(:cost).first %>

  <div style="display: grid; gap: 16px;">
    <div>
      <label for="<%= form.field_id(:title) %>" style="display: block; font-size: 14px; font-weight: 700; color: #111827; margin-bottom: 6px;">
        タイトル
        <span style="color: #dc2626; font-size: 12px; margin-left: 4px;">必須</span>
      </label>
      <%= form.text_field :title, required: true, placeholder: "例: 金閣寺観光", style: [
        "width: 100%",
        "padding: 12px",
        "border: 1px solid #{title_error ? '#fca5a5' : '#d1d5db'}",
        "border-radius: 10px",
        "font-size: 15px",
        "color: #111827",
        "background: #fff",
        "box-shadow: inset 0 1px 2px rgba(0,0,0,0.02)"
      ].join('; ') %>
      <% if title_error %>
        <p style="color: #b91c1c; font-size: 12px; margin: 6px 0 0;"><%= title_error_message %></p>
      <% end %>
    </div>

    <div>
      <label for="<%= form.field_id(:date) %>" style="display: block; font-size: 14px; font-weight: 700; color: #111827; margin-bottom: 6px;">
        日付
        <span style="color: #dc2626; font-size: 12px; margin-left: 4px;">必須</span>
      </label>
      <%= form.date_field :date, required: true, style: [
        "width: 100%",
        "padding: 12px",
        "border: 1px solid #{date_error ? '#fca5a5' : '#d1d5db'}",
        "border-radius: 10px",
        "font-size: 15px",
        "color: #111827",
        "background: #fff",
        "box-shadow: inset 0 1px 2px rgba(0,0,0,0.02)"
      ].join('; ') %>
      <% if date_error %>
        <p style="color: #b91c1c; font-size: 12px; margin: 6px 0 0;"><%= date_error_message %></p>
      <% end %>
    </div>

    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(160px, 1fr)); gap: 12px;">
      <div>
        <label for="<%= form.field_id(:start_time) %>" style="display: block; font-size: 14px; font-weight: 700; color: #111827; margin-bottom: 6px;">開始時刻</label>
        <%= form.time_field :start_time, style: "width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 10px; font-size: 15px; color: #111827; background: #fff; box-shadow: inset 0 1px 2px rgba(0,0,0,0.02);" %>
      </div>
      <div>
        <label for="<%= form.field_id(:end_time) %>" style="display: block; font-size: 14px; font-weight: 700; color: #111827; margin-bottom: 6px;">終了時刻</label>
        <%= form.time_field :end_time, style: "width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 10px; font-size: 15px; color: #111827; background: #fff; box-shadow: inset 0 1px 2px rgba(0,0,0,0.02);" %>
      </div>
    </div>

    <div>
      <label for="<%= form.field_id(:location) %>" style="display: block; font-size: 14px; font-weight: 700; color: #111827; margin-bottom: 6px;">場所</label>
      <%= form.text_field :location, placeholder: "例: 金閣寺 / 祇園", style: "width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 10px; font-size: 15px; color: #111827; background: #fff; box-shadow: inset 0 1px 2px rgba(0,0,0,0.02);" %>
    </div>

    <div>
      <label for="<%= form.field_id(:cost) %>" style="display: block; font-size: 14px; font-weight: 700; color: #111827; margin-bottom: 6px;">費用</label>
      <%= form.number_field :cost, min: 0, step: 1, placeholder: "例: 3000", style: [
        "width: 100%",
        "padding: 12px",
        "border: 1px solid #{cost_error ? '#fca5a5' : '#d1d5db'}",
        "border-radius: 10px",
        "font-size: 15px",
        "color: #111827",
        "background: #fff",
        "box-shadow: inset 0 1px 2px rgba(0,0,0,0.02)"
      ].join('; ') %>
      <% if cost_error %>
        <p style="color: #b91c1c; font-size: 12px; margin: 6px 0 0;"><%= cost_error_message %></p>
      <% end %>
    </div>

    <div>
      <label for="<%= form.field_id(:memo) %>" style="display: block; font-size: 14px; font-weight: 700; color: #111827; margin-bottom: 6px;">メモ</label>
      <%= form.text_area :memo, rows: 4, placeholder: "備考や持ち物、移動手段など", style: "width: 100%; padding: 12px; border: 1px solid #d1d5db; border-radius: 10px; font-size: 15px; color: #111827; background: #fff; line-height: 1.6; resize: vertical; box-shadow: inset 0 1px 2px rgba(0,0,0,0.02);" %>
    </div>

    <div style="display: flex; justify-content: flex-end;">
      <%= form.submit submit_label, style: "display: inline-flex; align-items: center; justify-content: center; gap: 6px; padding: 12px 18px; background: #2563eb; color: #fff; border: none; border-radius: 12px; font-size: 16px; font-weight: 700; cursor: pointer; box-shadow: 0 10px 25px rgba(37,99,235,0.18); width: 100%; max-width: 240px; transition: transform 0.08s ease, box-shadow 0.08s ease;", data: { turbo_submits_with: submit_loading } %>
    </div>
  </div>
<% end %>
